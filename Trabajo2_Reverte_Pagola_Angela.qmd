---
title: "Trabajo 2"
subtitle: "Elección club deportivo para practicar tenis"
author: "Ángela Reverte Pagola"
lang: es
format:
  html:
    toc: true      
    toc-depth: 3     
    number-sections: true
    embed-resources: true
  typst: 
    toc: true
    fig-format: png
  pdf: 
    toc: true
editor: visual
---

# PRESENTACIÓN DEL PROBLEMA.

Mi pasión siempre han sido los deportes. He practicado muchos como: natación, baloncesto, tenis o fútbol sala. Este año, quiero volver a jugar al tenis y me encuentro emocionada. El problema es que tengo muchas opciones de clubes de tenis donde apuntarme y no sé qué hacer.

Para mí, el deporte es algo esencial en mi vida y, aunque no me quiero dedicar de forma profesional, me gusta mucho que los entrenamientos sean muy intensos y lo más profesionales posibles. Sin embargo, creo que el ambiente debe ser divertido y relajado. Tan importante es hacer deporte serio como disfrutarlo y pasarlo bien.

Por otro lado, durante el día estoy muy ajetreada, por lo que es importante no perder tiempo en el desplazamiento. Lo ideal sería que el club estuviera cerca de casa o, por lo menos, que tuviera fácil aparcamiento.

En cuanto a lo económico, para mí no es tan importante. Los precios son todos parecidos, aunque sí es verdad que algunos incluyen más servicios que otros. De hecho, es importante destacar que no todos los clubes tienen las mismas instalaciones. A mi me encanta alquilar pistas con mi hermano y amigos para jugar. Y no todos los clubes tienen las mismas facilidades.

Veamos ahora las diferentes alternativas y una breve presentación de ellas:

-   Club Mirador: Club muy cercano a mi casa (5 mins andando). Es un club social y pequeño, pero muy familiar. Cuenta con una escuela de tenis que lleva este deporte también en otros clubes. Todos los monitores son profesionales y muy cercanos. El problema es que cuenta solo con una pista de tenis, por lo que, por un lado, las clases de tenis tienen un alto número de alumnos y, por otro, es difícil reservarla, pues siempre está ocupada. Esta escuela de tenis se preocupa mucho por hacer eventos y torneos. Siempre con el objetivo de pasarlo bien. Es perfecta para tener el tenis como ocio. Es bastante económica.

-   Club Bernier: aunque también es un club social, su objetivo principal es el tenis. Bastante profesional, pero sin perder de vista el ocio y el disfrute. Está también muy cerca de casa (10 mins andando). Cuenta con 4 pistas de tenis, gimnasio, pistas de padel y bar/restaurante. También realizan muchos partidos y torneos en los que te puedes poner a prueba como tenista. No es tan económico.

-   Club de tenis Río Grande: club dedicado al tenis. Este club se dedica al tenis, aunque cuenta también con otros muchos servicios como piscina, sala fitness, pistas de padel o campos de fútbol. Es un club muy grande, con 16 pistas de tenis, de las cuales 12 son de tierra batida y en muy buen estado. Hay grupos de entrenamientos en función de tus objetivos: ocio, entrenamiento intenso, mejorar la técnica... Se encuentra a 5 mins en coche de mi casa y tiene parking. Hay buen ambiente, pero al ser tan grande, se pierde un poco la familiaridad. Es más caro.

-   Real Club de Tenis Betis: club histórico de tenis en Sevilla. Reconocido a nivel nacional. Ideal si quieres mejorar y entrenar de forma intensa. Realiza grandes torneos y está hermanado con otros clubes de tenis de España. Cuenta con 6 pistas de tenis de tierra batida, gimansio, pistas de padel y piscina. Se sitúa en Sevilla, por lo que está a 15 minutos en coche, más el tiempo de aparcamiento. Es caro.

\pagebreak

# SOLUCIÓN PROBLEMA.

En primer lugar, vamos a presentar los criterios y subcriterios tenidos en cuenta:

-   Ambiente: la buena relación entre alumnos y monitores es esencial. Este criterio, los vamos a dividir en dos subcriterios: familiaridad y eventos deportivos. Familiaridad: se agradece el buen rollo y las ganas de disfrutar el deporte. Tanto entre los alumnos como con los monitores. Eventos deportivos: súper importante para crear vínculos con otros jugadores y para crear un ambiente deportivo y de competición.

-   Servicios: este criterio también lo vamos a dividir en dos subcriterios: pistas de tenis e instalaciones. En primer lugar, pistas de tenis: lo ideal es que haya varias pistas de tenis, para poder alquilarlas y que estén en buen estado. Instalaciones: siempre es mejor que el club posea otras istalaciones como gimnasio, pistas de padel o bar, para que se convierta en un club donde disfrutar, además de hacer deporte.

-   Ubicación y accesibilidad: debido a la falta de tiempo, lo ideal es que el club esté cerca de casa o, por lo menos, que sea fácil de aparcar con el coche.

-   Precio: debido a que no quiero dedicarme profesionalmente, los precios deben ser asequibles.

-   Entrenamientos: aunque mi principal objetivo sea divertirme mientras hago deporte, para mí es esencial que los entrenamientos sean intensos y competitivos.

Una vez presentados el problema, los criterios y las alternativas, procedemos a aplicar las diferentes técnicas de decisión multicriterio.

\pagebreak

## Resolución con AHP con R.

Con toda la información anterior, voy a contruir las tablas de comparación 2 a 2. Y calculamos los pesos locales:

```{r}
source("teoriadecision_funciones_multicriterio.R")
source("teoriadecision_funciones_multicriterio_diagram.R")
source("teoriadecision_funciones_multicriterio_utiles.R")
n.criterios = c("Ambiente","Servicios",
                 "Ubicación y accesibilidad",
                "Precio","Entrenamientos")
tab1 = multicriterio.crea.matrizvaloraciones_mej(
                                         c(2,1/3,5,3,1/4,3,1/2,6,2,1/7),
                                         5,n.criterios)
tab1
pl1 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab1)
(pl1r = round(pl1$valoraciones.ahp,4))
```

```{r}
#Ambiente:
n.criterios2 = c("Familiaridad","Eventos deportivos")
tab2 = multicriterio.crea.matrizvaloraciones_mej(c(2),2,n.criterios2)
tab2
pl2 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab2)
(pl2r = round(pl2$valoraciones.ahp,4))
```

```{r}
#Servicios
n.criterios3 = c("Pistas de tenis","Instalaciones")
tab3 = multicriterio.crea.matrizvaloraciones_mej(c(6),2,n.criterios3)
tab3
pl3 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab3)
(pl3r = round(pl3$valoraciones.ahp,4))
```

De esta forma, ya tenemos todos los pesos locales de todos los criterios y subcriterios:

```{r}
C11 = 0.2554 * 0.6667
C12 = 0.2554 * 0.3333 
C21 = 0.1037 * 0.8571
C22 = 0.1037 * 0.1429
C3 = 0.4157
C4 = 0.0419 
C5 = 0.1833

crisub = c(C11,C12,C21,C22,C3,C4,C5)
crisub
```

Del mismo modo, calculamos los pesos locales para las alternativas en función de cada criterio y subcriterio:

```{r}
#Familiaridad
n.alternativas = c("Mirador","Bernier","Río Grande","Tenis Betis")
tab4 = multicriterio.crea.matrizvaloraciones_mej(c(2,4,6,2,4,2),
                                                 4,n.alternativas)
tab4
pl4 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab4)
(pl4r = round(pl4$valoraciones.ahp,4))
```

```{r}
#Eventos deportivos
tab5 = multicriterio.crea.matrizvaloraciones_mej(c(1/3,1/5,1/6,1/3,1/5,1/3),
                                                 4,n.alternativas)
tab5
pl5 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab5)
(pl5r = round(pl5$valoraciones.ahp,4))
```

```{r}
#Pistas de tenis
tab6 = multicriterio.crea.matrizvaloraciones_mej(c(1/3,1/9,1/6,1/7,1/2,6),
                                                 4,n.alternativas)
tab6
pl6 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab6)
(pl6r = round(pl6$valoraciones.ahp,4))
```

```{r}
#Instalaciones
tab7 = multicriterio.crea.matrizvaloraciones_mej(c(1/2,1/5,2,1/3,2,4),
                                                 4,n.alternativas)
tab7
pl7 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab7)
(pl7r = round(pl7$valoraciones.ahp,4))
```

```{r}
#Ubicación
tab8 = multicriterio.crea.matrizvaloraciones_mej(c(2,5,9,3,8,7),
                                                 4,n.alternativas)
tab8
pl8 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab8)
(pl8r = round(pl8$valoraciones.ahp,4))
```

```{r}
#Precio
tab9 = multicriterio.crea.matrizvaloraciones_mej(c(3,5,6,2,4,2),
                                                 4,n.alternativas)
tab9
pl9 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab9)
(pl9r = round(pl9$valoraciones.ahp,4))
```

```{r}
#Entrenamientos
tab10 = multicriterio.crea.matrizvaloraciones_mej(c(1/4,1/5,1/8,1/3,1/6,1/3),
                                                  4,n.alternativas)
tab10
pl10 = multicriterio.metodoAHP.variante1.autovectormayorautovalor(tab10)
(pl10r = round(pl10$valoraciones.ahp,4))
```

Una vez calculados los pesos locales, pasamos a los pesos globales. Al ser un problema multinivel, los vamos a calcular a mano. Aunque podamos sacar todas las conclusiones con estos resultados, voy a terminar de explicarlas con la librería AHP, pues todas las tablas se aprecian mucho mejor y tenemos las mismas soluciones pero de forma más visual.

```{r}
matper = matrix(c(0.5132,0.2751,0.1376,0.0741,
                  0.0589,0.1195,0.2661,0.5554,
                  0.0434,0.0993,0.6780,0.1794,
                  0.1349,0.2116,0.5529,0.1006,
                  0.5157,0.3050,0.1431,0.0362,
                  0.5715,0.2355,0.1224,0.0706,
                  0.0482,0.1182,0.2500,0.5836),ncol=4,nrow=7,byrow = TRUE)
pond.globales = crisub %*% matper
colnames(pond.globales) = n.alternativas
pond.globales
round(pond.globales*100,2)
```

```{r}
Mcrisub = matrix(crisub,ncol=4,nrow=7)
Mcrisub
pond.globales.parciales = Mcrisub*matper
round(pond.globales.parciales*100,2)

```

CONCLUSIONES: Viendo los resultados, elegiríamos el club Mirador, con un 34,54%, seguido del club Bernier con un 22.73%. Las interpretaciones de por qué han salido estos resultados, la vamos a ver mejor con la librería AHP como he comentado anteriormente.

Veamos ahora la inconsistencia de cada una de las tablas:

```{r}
Inconsistencia1 = multicriterio.metodoAHP.coef.inconsistencia(tab1)
c(Inconsistencia1$mensaje, round(Inconsistencia1$RI.coef.inconsistencia,4) )

Inconsistencia2 = multicriterio.metodoAHP.coef.inconsistencia(tab2)
c(Inconsistencia2$mensaje, round(Inconsistencia2$RI.coef.inconsistencia,4) )

Inconsistencia3 = multicriterio.metodoAHP.coef.inconsistencia(tab3)
c(Inconsistencia3$mensaje, round(Inconsistencia3$RI.coef.inconsistencia,4) )

Inconsistencia4 = multicriterio.metodoAHP.coef.inconsistencia(tab4)
c(Inconsistencia4$mensaje, round(Inconsistencia4$RI.coef.inconsistencia,4) )

Inconsistencia5 = multicriterio.metodoAHP.coef.inconsistencia(tab5)
c(Inconsistencia5$mensaje, round(Inconsistencia5$RI.coef.inconsistencia,4) )

Inconsistencia6 = multicriterio.metodoAHP.coef.inconsistencia(tab6)
c(Inconsistencia6$mensaje, round(Inconsistencia6$RI.coef.inconsistencia,4) )

Inconsistencia7 = multicriterio.metodoAHP.coef.inconsistencia(tab7)
c(Inconsistencia7$mensaje, round(Inconsistencia7$RI.coef.inconsistencia,4) )

Inconsistencia8 = multicriterio.metodoAHP.coef.inconsistencia(tab8)
c(Inconsistencia8$mensaje, round(Inconsistencia8$RI.coef.inconsistencia,4) )

Inconsistencia9 = multicriterio.metodoAHP.coef.inconsistencia(tab9)
c(Inconsistencia9$mensaje, round(Inconsistencia9$RI.coef.inconsistencia,4) )

Inconsistencia10 = multicriterio.metodoAHP.coef.inconsistencia(tab10)
c(Inconsistencia10$mensaje, round(Inconsistencia10$RI.coef.inconsistencia,4) )
```

Podemos comprobar que todas las matrices tienen consistencia aceptable. Por lo que las valoraciones que hemos puesto tienen sentido. No hay errores de inconsistencia y en las tablas no se forman ciclos entre preferencias de las alternativas y criterios.

\pagebreak

## Resolución con AHP con librería AHP.

Ahora vamos a hacer lo mismo, pero con la ayuda de la librería AHP. Para ello, he plasmado toda la información en el fichero esquema.ahp. Deben salir las mismas conclusiones, pero vamos a comentarlas en esta sección, pues la salida es mucho más visual e intuitiva.

```{r}
library(ahp)
datos = Load("esquema.ahp")
Calculate(datos)
```

```{r}
#| fig-width: 12
#| fig-height: 6
Visualize(datos)
```



```{r}
#pesos globales:
t1 = AnalyzeTable(datos)
#export_formattable(AnalyzeTable(datos), file = "tablaahpGlobal.png")
```

![](tablaahpGlobal.png)


```{r}
#pesos locales:
t2 = AnalyzeTable(datos, variable = "priority")
#export_formattable(t2, file = "tablaahpLocal.png")
#formattable::as.htmlwidget(t1)
#formattable::as.htmlwidget(t2)
```

![](tablaahpLocal.png)

CONCLUSIONES:

Viendo las tablas podemos sacar muchas conclusiones, por ejemplo:

-   Elegimos la opción club Mirador, pues es el que tiene mejor puntuación: 34.5%.

-   Lo que más le puntúa para ser elegido es la ubicación y accesibilidad. Se le ha dado mucha importancia a que el club de tenis esté cerca de casa y, el club Mirador es el mejor en este aspecto. Además, al ser un club pequeño, hay mucha familiaridad y un muy buen ambiente, por lo que esto le suma mucho también. Teniendo en cuenta que son los dos criterios con más peso, esta alternativa sale ganadora.

-   Del mismo modo se puede pensar con el club Bernier. Se caracteriza por la ubicación y el ambiente. Aún así, al tener peores valoraciones que el club Mirador, se queda en segunda posición.

-   Por otro lado, el club Río Grande. El mejor en cuanto a los servicios debido al gran número de pistas de tenis que posee. Sin embargo, este no es el criterio con más peso y en los demás no es el mejor. Por eso termina en tercera posición.

-   Por último, el club Tenis Betis. La ubicación y accesibilidad es lo que más le penaliza, pues tiene muy mala valoración y es el criterio con más peso. Es el mejor en los entrenamientos, pues es un club bastante serio, pero no es suficiente para ser elegido.

-   La diferencia de pesos en los criterios hace realmente que nos decantemos por una u otra alternativa.

-   Se puede comprobar que todas las comparaciones tienen una inconsistencia de menos de un 10%, por lo que hemos valorado con buen criterio y sin muchas inconsistencias.

\pagebreak

## Resolución con Electre.

En primer lugar creamos la matriz de decisión. Para ello, vamos a tratar los subcriterios como criterios y de esta forma veremos más fácil como aplicar este método. Vamos a darle estos valores a cada alternativa en cada criterio:

-   Familiaridad: como es algo subjetivo, voy a poner un porcentaje en función de mi propio criterio. Este criterio lo querremos maximizar. Para obtener estos valores he mantenido las diferencias dadas en la tabla AHP, pero esta vez de forma porcentual.
-   Eventos deportivos: una media de cuántos torneos por mes. Lo ideal es tener el máximo número de torneos al mes.
-   Pistas de tenis: nº de pistas de tenis. Es algo objetivo. Cuantas más pistas de tenis tenga un club, mejor será valorado.
-   Instalaciones: valoración en porcentaje personal. Viendo las instalaciones que ofrecen cada club en sus páginas webs, les proporciono una nota personal. La valoración será en porcentaje y la querremos maximizar.
-   Ubicación y accesibilidad: tiempo de trayecto. Como hay clubes que se pueden ir andando y otros que se tiene que ir en coche, voy a poner una penalización al tiempo de ir en coche. Es decir, si es necesario ir en coche, voy a añadirle al tiempo 5 mins más debido al aparcamiento y como penalización en sí de tener que coger un vehículo. El objetivo de este criterio será minimizarlo.
-   Precio: Cuota mensual (euros). El objetivo es minimizar el gasto mensual.
-   Entrenamientos: valoración en porcentaje personal. Leyendo las descripciones de los clubes en sus páginas webs y por experiencia personal, voy a decidir una nota de lo que creo que van a ser los entrenamientos. El objetivo va a ser maximizar este criterio, pues lo ideal es que los entrenamientos sean intensos y competitivos.

Los de minimizar, los añadimos directamente con el menos.

```{r}
matrizDec = multicriterio.crea.matrizdecision(
  c(100, 4,  1,  50,  -5,  -45, 60,
    75,  3,  4,  60,  -10, -55, 75,
    50,  2,  16, 90,  -10, -60, 85,
    25,  1,  6,  20,  -20, -70, 100),
  numalternativas = 4,
  numcriterios = 7,
  v.nombresalt = c("Mirador","Bernier","Río Grande","Tenis Betis"),
  v.nombrescri = c('Fam.', 'Eventos', 'Nº Pistas', 'Instalaciones', 'Ubicación', 'Precio','Entr.')
)
matrizDec
```

Vamos a usar los pesos de los criterios que hemos obtenido con el AHP, para poder compararlos. Además, tiene sentido, pues yo soy la que le doy más importancia a uno o a otro criterio.

Además, voy a usar para el test de discordancia los siguientes valores para las diferencias:

-   Eventos deportivos: si hay una diferencia de 5 eventos, para mí esa diferencia es demasiada y por lo tanto la voy a tener en cuenta.
-   Pistas: si hay una diferencia de 10 pistas. Se puede comprobar la diferencia de dos clubes con el número de pistas de tenis que poseen.
-   Ubicación y accesibilidad: si hay una diferencia de 15 minutos de trayecto. El tiempo es fundamental para mí. Una diferencia de más de 15 minutos supone grandes consecuencias para mi día.
-   Precio: si hay una diferencia mensual de 50 euros. Para mí el precio no era un criterio muy importante pues más o menos los precios son similares. Sin embargo, una diferencia de 50 euros sí es algo excesivo.

Resolvemos electre con esta información:

```{r}
solElec = multicriterio.metodoELECTRE_I(
  matrizDec,
  pesos.criterios = crisub,
  nivel.concordancia.minimo.alpha = 0.7,
  no.se.compensan = c(Inf, 5, 10, Inf, 15,50,Inf),
  que.alternativas = TRUE
)

#solElec

qgraph::qgraph(solElec$relacion.dominante)

solElec$nucleo_aprox
```

Viendo este grafo y viendo el núcleo obtenido, vamos a modificar el alpha para que nos quedemos solo con una alternativa. Es decir, ponemos más restrictivo el superar el test de concordancia.Y nos quedamos solo con las alternativas posibles: club Mirador y club Río Grande:

```{r}
solElec2 = multicriterio.metodoELECTRE_I(
  matrizDec,
  pesos.criterios = crisub,
  nivel.concordancia.minimo.alpha = 0.55,
  no.se.compensan = c(Inf, 5, 10, Inf, 15,50,Inf),
  que.alternativas = c(1,3)
)

#solElec2

qgraph::qgraph(solElec2$relacion.dominante)

solElec2$nucleo_aprox
```

Puesto que todavía no hemos llegado a ninguna solución, vamos a modificar también el test de discordancia. Como en realidad no necesito tantas pistas de tenis y, además, siempre tengo la opción de alquilarla en cualquier otro lugar, voy a modificar esa restricción.

```{r}
solElec3 = multicriterio.metodoELECTRE_I(
  matrizDec,
  pesos.criterios = crisub,
  nivel.concordancia.minimo.alpha = 0.55,
  no.se.compensan = c(Inf, 5, Inf, Inf, 15,50,Inf),
  que.alternativas = c(1,3)
)

#solElec3

qgraph::qgraph(solElec3$relacion.dominante)

solElec3$nucleo_aprox
```

CONCLUSIÓN:

Según el procedimiento de Electre también llegamos a la misma conclusión: quedarnos con la alternativa del club Mirador. Con los datos que le he proporcionado, ha sido complicada la elección entre las alternativas de club Mirador y de club Río Grande. Sin embargo, cambiando un poco las restricciones de los test de concordancia y discordancia en función de nuestro criterio y lógica, hemos podido concluir y tomar una decisión.

\pagebreak

### Electre completo con tablas.

Por otro lado, si queremos ver los pasos intermedios y las tablas de concordancia y discordancia, lo detallo a continuación. (Detallo solo con las restricciones finales)

```{r}
#Electre con todos los pasos:
completo = func_ELECTRE_Completo(solElec3)

#aquí las tablas de los índices:
#kableExtra::save_kable(completo$MIndices$KE, file = "electreTI.html")
#webshot::webshot("electreTI.html", file = "electreTI.png",,vheight = 344)
```

![](electreTI.png)

```{r}
# echo: false
# out-width: "80%"
#tabla del test de concordancia:
#kableExtra::save_kable(completo$TConcordancia$KE, file = "electreTC.html")
#webshot::webshot("electreTC.html", file = "electreTC.png",vheight = 344)
```

![](electreTC.png)

```{r}
#tabla de discordancia:
#kableExtra::save_kable(completo$TDiscordancia$KE, file = "electreTD.html")
#webshot::webshot("electreTD.html", file = "electreTD.png",vheight = 344)
```

![](electreTD.png)


```{r}
#tabla de superación de los dos test:
#kableExtra::save_kable(completo$TSuperacion$KE, file = "electreTS.html")
#webshot::webshot("electreTS.html", file = "electreTS.png",,vheight = 344)
```

![](electreTS.png)

Con estas tablas podemos comprobar que el par (a1,a3) supera ambos tests (el de concordancia y el de discordancia), pero que el par (a3,a1) no supera el test de concordancia. Por ello, la alternativa 1 (club Mirador) supera a la alternativa 3 (club Río Grande)

\pagebreak

## Resolución con Promethee con R.

### Promethee I

A continuación voy a resolver el problema con la técnica de Promethee. Para ello, voy usar la misma matriz de decisión, los mismos pesos (para poder comparar y porque realmente muestran mis preferencias). Para las funciones de preferencia, voy a tomar una distinta en cada criterio.

-   Familiaridad: preferencia lineal (q=5,p=30)
-   Eventos deportivos: cuasi criterio (q=0.5)
-   Nº Pistas: criterio con preferencia lineal y área de indiferencia (q=2,p=8)
-   Instalaciones: criterio nivel (q=5,p=30)
-   Ubicación: criterio usual (p=8)
-   Precio: preferencia lineal (q=3,p=12)
-   Entrenamientos: cuasi criterio (q=1)

Las funciones de preferencias quedarían así:

```{r}
#                  num fun  q    p   s
tab.fpref = matrix( c(3,    5,  30,  0,
                      2,  0.5,   0,  0,
                      5,    2,   8,  0,
                      4,    5,  30,  0,
                      1,    0,   8,  0,
                      3,    3,  12,  0,
                      2,    1,   0,  0),ncol=4,byrow=TRUE)
```

Aplico Promethee I en primer lugar:

```{r}
tab.Pthee.i = multicriterio.metodo.promethee_i(matrizDec,crisub,tab.fpref)
tab.Pthee.i
require(qgraph)
qgraph(tab.Pthee.i$tablarelacionsupera)
```

Según los resultados del Promethee I, Mirador aparece como la alternativa con mayor capacidad de dominancia (mayor flujo entrante), seguida de Río Grande y Bernier, mientras que Tenis Betis resulta la menos preferida al presentar el menor flujo de entrada. En cuanto al flujo saliente (cuánto las alternativas son dominadas por las demás), la menor es club Mirador, seguido de Río Grande, Bernier y, por último, Tenis Betis. La matriz de relación de superación confirma que el club Mirador domina al resto de clubes, evidenciando una clara ventaja respecto a los criterios considerados.

Casualmente ninguna es incomparable ni indiferente, pues los flujos entrantes y salientes están ordenados de la misma manera. Es decir, no existe ninguna alternativa que tenga mejor flujo entrante que otra, pero peor flujo saliente. Por lo que las conclusiones son mucho mejores. Las alernativas con Promethee I quedan ya perfectamente ordenadas.

\pagebreak

### Promethee II

Para terminar de confirmar nuestras hipótesis, vamos a realizar Promethee II y obtener el ranking final según los flujos netos:

```{r}
tab.Pthee.ii = multicriterio.metodo.promethee_ii(matrizDec,crisub,tab.fpref)

require(qgraph)
qgraph(tab.Pthee.ii$tablarelacionsupera)

#ordenacion final promethee 2:
tab.Pthee.ii$vflujos.netos
order(tab.Pthee.ii$vflujos.netos,decreasing=TRUE)
```

CONCLUSIONES PROMETHEE:

Como habíamos visto antes, la mejor alternativa según Promethee es el club Mirador, seguida por Río Grande, Bernier y, por último, Tenis Betis.

Además, se puede comprobar la gran diferencia entre los distintos flujos netos, por lo que Promethee realiza una buena diferencia entre las distintas alternativas. También, cabe destacar que la única alternativa con flujo neto negativo es Tenis Betis, por lo que se puede decir que, en general, esta alternativa es más dominada de lo que ella domina.

\pagebreak

## Promethee Windows.

Veamos en primer lugar el planteamiento del problema con Windows. Voy a usar la opción de poner los valores de los criterios de minimizar en positivo, pero especificando si quiero minimizar o maximizar los criterios.

```{r}
(res = multicriterio.metodo.promethee_windows(matrizDec,
                                              tab.fpref,
                                              crisub,
    fminmax = c("max","max","max","max","min","min","max") ))
```

Veamos los resultados:

Aunque los flujos netos sean un poco distintos, se sigue manteniendo el mismo orden de preferencias de las alternativas. En primer lugar el club Mirador, con un flujo neto de 0.466, seguido de Río Grande (0.0715), Bernier (0.0100) y, por último, Tenis Betis (-0.5475). Siendo esta última, la única con flujo neto negativo otra vez. Además, vuelven a ser todas comparables y se puede volver a ver un orden de alternativas claro.

\pagebreak

## Método Axiomático de Arrow y Raymond

Por último, vamos a usar el método de Arrow y Raymond. Para este método, volvemos a usar la misma matriz de decisión:

```{r}
arrow = multicriterio.metodoaxiomatico.ArrowRaymond(matrizDec)
arrow
```

CONCLUSIONES

Según el método de Arrow y Raymond, la mejor alternativa es el club Mirador, seguido del club Río Grande, Bernier y Tenis Betis.

Además, podemos hacer el análisis de sensibilidad:

\pagebreak

### Análisis paramétrico o de sensibilidad (Arrow y Raymond)

Vamos a ver cómo cambian los resultados finales si voy modificando las valoraciones de la primera alternativa en todos los criterios (haremos un bucle).

Comenzamos inicialmente con la matriz de decisión usada durante todo el estudio.

```{r}
intalpha = seq(1,2,0.1)
sols = vector("list",length(intalpha))
for (i in 1:length(intalpha)) {
  pej7_i = matrizDec   #vuelvo a copiar la matriz original
  pej7_i[1,] = pej7_i[1,] * intalpha[i]    #modifico la fila 1
  sej7_i = multicriterio.metodoaxiomatico.ArrowRaymond(pej7_i)  
  sols[[i]] = sej7_i$alternativasordenadas    #veo el resultado de cada matriz
}
sols

```

```{r}
#veamos las posiciones de a1 en este bucle:
posiciones_a1 = rep(NA,length(intalpha))
for (i in 1:length(intalpha)) {
  #i = 1
  posiciones_a1[i] = which(sols[[i]]=="Mirador")
}
posiciones_a1
#ha ido mejorando las posiciones: de 5 a 3


#lo representamos con un plot:
plot(intalpha,posiciones_a1,type= "l")
```

CONCLUSIONES:

Vemos que para todos los valores por los que se multiplica la fila 1 (alternativa Mirador), la alternativa Mirador es la mejor, seguida de: Río Grande, Bernier y Tenis Betis. Sin embargo, hay una excepción, cuando la multiplico por 1,4. En esa iteración, club Mirador y club Río Grande cambian los papeles. Es algo curioso.

\pagebreak

# CONCLUSIÓN.

Vemos que en todos los métodos, la alternativa club Mirador es la mejor opción. Tiene sentido pues, con los pesos que se han obtenido con la tabla AHP, la ubicación y accesibilidad es el criterio con más peso, seguido de entrenamientos y familiaridad.

El club Mirador es el mejor ubicado con respecto a mi casa y tiene un gran ambiente al ser un club pequeño y familiar.

En segundo lugar, siempre aparece el club Río Grande, con excepción del método AHP (tercera posición), pero igualado prácticamente con el club Bernier. Por último, el club Tenis Betis siempre es el peor valorado. Tiene sentido, su principal característica son los entrenamientos, pero en todo lo demás siempre toma peores valores que las otras alternativas.

Por lo tanto, tomaría la decisión de apuntarme al club Mirador.

\pagebreak

# BIBLIOGRAFÍA.

Toda la información ha sido extraída de estas páginas webs y de mi experiencia personal (decisión personal que tuve que tomar).

-   https://clubelmirador.com/inicio
-   https://escueladetenisfermingomez.es/
-   https://clubbernier.com/
-   https://riogrande.es/
-   https://www.tenisbetis.com/index.php?id=10
